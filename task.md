次期開発フェーズ 詳細タスクチェックリスト
このリストは、アプリの安定性向上とリリース準備を目的とした、次の開発フェーズにおける主要なタスクを整理したものです。



まずやるべきこと

[x]'package:flutter_riverpod/src/consumer.dart': Failed assertion: line 600 pos 7: 'debugDoingBuild':

ref.listen can only be used within the build method of a ConsumerWidget

See also: https://docs.flutter.dev/testing/errors　このエラーを修正して、エラーが出ないようにし、Home画面が出るようにする





💾 データ記録・同期パイプラインの実装
ログデータの永続化、同期、および統計表示の基盤構築に関わる P0 必須タスクです。

ログ記録と統計基盤
[x] QuestLog 保存（Record → Isar）：ユーザーの記録データをローカルDB (Isar) に保存するパイプラインを実装する。

[x] 同期（Isar → Firestore）：ローカルの QuestLog をクラウドDB (Firestore) に同期するロジックを実装する。

[x] 再起動後に反映確認：アプリの再起動後、データがローカルとクラウドの両方で正しく保持・反映されていることを確認する。

[x] Stats 実データ化：統計画面（Stats）の表示をダミーデータではなく、実際の QuestLog データに基づいたものにする。

[x] Heatmap/Streak を QuestLogRepository 直結：ヒートマップおよびストリークの算出ロジックをデータリポジトリに直結させる。

[x] ローディング/エラー表示の分岐：データ取得中（ローディング）および取得失敗時（エラー）のUI表示分岐を実装する。

[x]モックデータをすべてなくし動的データへと書き換える

🔔 通知・権限 UX および国際化 (i18n)
ユーザー体験に直結する通知と、多言語対応の完了を目指します。

通知と権限UX
[ ] 通知・権限 UX 通し：通知関連のユーザー体験（UX）を一連の流れでテスト・確認する。

[ ] プリプロンプト → OS権限 → スケジューリング：通知許諾のための事前プロンプトからOSの許可ダイアログ、その後の通知スケジューリングまでの一連の導線を実装し確認する。

[ ] テスト通知 → DeepLink 動作確認：テスト通知が正しく配信され、押下時に DeepLink で目的の画面へ遷移することを確認する。

国際化 (i18n)
[ ] i18n 完了（en/ja）：日本語（ja）と英語（en）の多言語対応を完了させる。

[ ] 全文言の ARB 化：SnackBar、Dialog、通知文言を含むすべてのアプリ内文言を ARB ファイルに移行し、ハードコーディングを排除する。

[ ] ロケール切替でUI差分ゼロ：アプリ内でのロケール（言語）切り替え操作時に、UIのレイアウト崩れや表示差分が一切ないことを確認する。

💻 コード品質・アーキテクチャ
アプリの安定性と保守性を高めるための基礎的な品質向上タスクです。

[ ] Null 安全の穴ふさぎ：すべての箇所で Null Safety の問題を解決する。

[ ] pairRepositoryProvider の ! 除去：プロバイダで非 Null 主張演算子（!）の使用を避け、null の場合は安全な処理（例：空の Stream を返す）に置き換える。

[ ] isarProvider 前提箇所を待機/ガード：isarProvider の初期化が完了するまで、依存するコンポーネントが待機するか、適切にガード（エラー表示やローディング）されるように実装する。

[ ] 依存関係の固定 & CI：pubspec.yaml 内の依存パッケージを固定バージョン（例：^x.y.z）に統一し、any を排除する。

[ ] CI：analyze/test/pub outdated 追加：CIパイプラインに、コード解析、テスト実行、依存パッケージの更新チェックを追加する。

[ ] アクセシビリティ調整：

[ ] textScaler 上限撤廃 or 2.0：フォントサイズの拡大の上限を撤廃するか、少なくとも 2.0× まで許容するように設定する。

[ ] 主要アイコンに semanticsLabel：スクリーンリーダー対応として、主要なアイコンに適切な代替テキストを設定する。
